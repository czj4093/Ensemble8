# Scene Graph

​		JavaFX场景图是构建JavaFX应用程序的起点。它是节点的分层树，代表应用程序用户界面的所有可视元素。它可以处理输入并可以呈现。

​		场景图中的单个元素称为节点。每个节点都有一个ID，样式类和边界量。除了场景图的根节点之外，场景图中的每个节点都有一个父级和零个或多个子级。它还可以具有以下内容：

- 效果，例如模糊和阴影
- 不透明度
- 变身
- 事件处理程序（例如鼠标，键和输入法）
- 特定于应用程序的状态

#  Java Public APIs for JavaFX Features

​		JavaFX体系结构的顶层提供了一组完整的Java公共API，这些API支持富客户端应用程序开发。这些API为构建富客户端应用程序提供了无与伦比的自由度和灵活性。JavaFX平台将Java平台的最佳功能与全面的沉浸式媒体功能相结合，形成了直观，全面的一站式开发环境。这些用于JavaFX的Java API功能：

- 允许使用强大的Java功能，例如泛型，注释，多线程和Lamda表达式（在Java SE 8中引入）。
- 使Web开发人员更容易使用其他基于JVM的动态语言（例如Groovy和JavaScript）中的JavaFX。
- 允许Java开发人员使用其他系统语言（例如Groovy）来编写大型或复杂的JavaFX应用程序。
- 允许使用包括对高性能延迟绑定，绑定表达式，绑定序列表达式以及部分绑定重新评估的支持的绑定。替代语言（例如Groovy）可以使用此绑定库来引入类似于JavaFX Script的绑定语法。
- 扩展Java集合库以包括可观察的列表和映射，这使应用程序可以将用户界面连接到数据模型，观察那些数据模型中的更改并相应地更新相应的UI控件。

# Graphics System

​		JavaFX图形系统是JavaFX场景图形层下面的实现细节。它支持2-D和3-D场景图。当系统上的图形硬件不足以支持硬件加速渲染时，它将提供软件渲染。

​		JavaFX平台上实现了两个图形加速管道：

-  **Prism** 过程提供了工作。它可以在包括3-D在内的硬件和软件渲染器上运行。它负责JavaFX场景的栅格化和渲染。根据所使用的设备，可以使用以下多个渲染路径：

  - Windows XP和Windows Vista上的DirectX 9

  - Windows 7上的DirectX 11

  - Mac，Linux，嵌入式上的OpenGL

  - 无法进行硬件加速时的软件渲染

    尽可能使用完全硬件加速的路径，但如果不可用，则使用软件渲染路径，因为软件渲染路径已经在所有Java运行时环境（JRE）中分发。在处理3D场景时，这一点尤其重要。但是，使用硬件渲染路径时，性能会更好。

- **Quantum Toolkit**将Prism和Glass Windowing Toolkit捆绑在一起，并使它们可用于堆栈中位于其上方的JavaFX层。它还管理与渲染与事件处理相关的线程规则。

# Glass Windowing Toolkit

​		 Glass Windowing Toolkit是JavaFX图形堆栈中的最低级别。它的主要职责是提供本机操作服务，例如管理窗口，计时器和表面。它用作将JavaFX平台连接到本机操作系统的平台相关层。 

 		Glass工具包还负责管理事件队列。与管理自己的事件队列的抽象窗口工具包（AWT）不同，Glass工具包使用本机操作系统的事件队列功能来调度线程使用。另外，与AWT不同，Glass工具包与JavaFX应用程序在同一线程上运行。 

## Threads

​		系统在任何给定时间运行两个或多个以下线程。

- **JavaFX应用程序线程**：这是JavaFX应用程序开发人员使用的主要线程。必须从此线程访问任何“实时”场景，该场景是窗口的一部分。可以在后台线程中创建和操作场景图，但是当场景树的根节点连接到场景中的任何活动对象时，必须从JavaFX应用程序线程访问该场景图。这使开发人员可以在后台线程上创建复杂的场景图，同时保持“实时”场景上的动画流畅，快速。JavaFX应用程序线程是与Swing和AWT事件调度线程（EDT）不同的线程，因此在将JavaFX代码嵌入到Swing应用程序中时必须小心。
- **Prism render thread**：此线程与事件分配器分开处理渲染。它允许在处理帧N +1时渲染帧N。执行并发处理的能力是一个很大的优势，特别是在具有多个处理器的现代系统上。Prism渲染线程可能还具有多个栅格化线程，这些线程可以帮助减轻渲染中需要完成的工作。
- **媒体线程**：此线程在后台运行，并使用JavaFX应用程序线程通过场景图同步最新的帧。

## Pulse

​		脉冲是一个事件，向JavaFX场景图指示是时候将场景图上元素的状态与Prism同步了。最多以每秒60帧（fps）的速度调节脉冲，并在场景图上运行动画时将其触发。即使动画没有运行，当场景图中的某些内容发生更改时，也会安排一个脉冲。例如，如果按钮的位置改变，则调度脉冲。

​		发射脉冲时，场景图上元素的状态向下同步到渲染层。脉冲使应用程序开发人员可以异步处理事件。这一重要功能使系统可以批量处理和执行脉冲事件。

​		布局和CSS也与脉冲事件相关。场景图中的许多更改都可能导致多个布局或CSS更新，从而可能严重降低性能。系统每个脉冲自动执行一次CSS和布局遍历，以避免性能下降。应用程序开发人员还可以根据需要手动触发布局遍历，以便在脉冲之前进行测量。

​		Glass Windowing Toolkit负责执行脉冲事件。它使用高分辨率的本地计时器进行执行。

# Media and Images

​		JavaFX媒体功能可通过`javafx.scene.media`API获得。JavaFX同时支持视觉和音频媒体。提供了对MP3，AIFF和WAV音频文件以及FLV视频文件的支持。JavaFX媒体功能是作为三个独立的组件提供的：Media对象代表媒体文件，MediaPlayer播放媒体文件，MediaView是显示媒体的节点。

​		Media Engine组件在设计时充分考虑了性能和稳定性，并提供跨平台的一致行为。

# Web Component

​		Web组件是基于Webkit的JavaFX UI控件，它通过其API提供Web查看器和完整的浏览功能。该Web引擎组件基于WebKit，WebKit是一个开源Web浏览器引擎，支持HTML5，CSS，JavaScript，DOM和SVG。它使开发人员能够在其Java应用程序中实现以下功能：

- 从本地或远程URL呈现HTML内容

- 支持历史记录并提供前进和后退导航

- 重新加载内容

- 将效果应用于Web组件

- 编辑HTML内容

- 执行JavaScript命令

- 处理事件

  ​	该嵌入式浏览器组件由以下类组成：

- `WebEngine` 提供基本的网页浏览功能。

- `WebView`封装WebEngine对象，将HTML内容合并到应用程序的场景中，并提供字段和方法来应用效果和转换。它是`Node`类的扩展。

  

  此外，可以通过JavaScript控制Java调用，反之亦然，以允许开发人员充分利用这两种环境。

# CSS

​	 JavaFX级联样式表（CSS）提供了将自定义样式应用于JavaFX应用程序的用户界面的功能，而无需更改该应用程序的任何源代码。CSS可以应用于JavaFX场景图中的任何节点，并且可以异步地应用于节点。JavaFX CSS样式也可以在运行时轻松地分配给场景，从而允许应用程序的外观动态变化。 

 		JavaFX CSS基于W3C CSS版本2.1规范，并在版本3的当前工作中进行了一些补充。JavaFX CSS支持和扩展旨在允许任何兼容的CSS解析器（即使是一个兼容的CSS解析器）也可以干净地解析JavaFX CSS样式表。不支持JavaFX扩展。这样可以将用于JavaFX和其他目的（例如HTML页面）的CSS样式混合到一个样式表中。所有JavaFX属性名称都以“ `-fx-`” 供应商扩展名作为前缀，包括那些似乎与标准HTML CSS兼容的名称，因为某些JavaFX值的语义略有不同。 

# UI Controls

​		 通过JavaFX API可用的JavaFX UI控件是通过使用场景图中的节点构建的。它们可以充分利用JavaFX平台的视觉丰富功能，并且可以跨不同平台移植。JavaFX CSS允许UI控件的主题化和外观化。 

# Layout

​		布局容器或窗格可用于允许JavaFX应用程序的场景图中的UI控件灵活，动态地排列。JavaFX Layout API包含以下容器类，这些容器类可自动执行常见的布局模型：

- 本`BorderPane`类勾画出其内容节点上，下，左，右，或中心区域。

- 该`HBox`级水平排列其内容节点在单行。

- 所述`VBox`类垂直排列其内容节点在单个列中。

- 该`StackPane`班将它的内容节点在后到前的单堆。

- 本`GridPane`类允许开发人员创建的行和列的灵活的网格中，奠定了内容节点。

- 的`FlowPane`类排列在水平或垂直它的内容节点“流”，包裹在指定的宽度（对于水平）或高度（对于垂直）的边界。

- 该`TilePane`班将它的内容节点，大小均匀的布局单元格或瓷砖

- 在`AnchorPane`类允许开发人员创建锚节点的顶部，底部，左侧，或中心的布局。

  

  为了实现所需的布局结构，可以在JavaFX应用程序中嵌套不同的容器。

# 2-D and 3-D Transformations

​		可以使用以下`javafx.scene.tranform`类在xy坐标中转换JavaFX场景图中的每个节点：

- `translate` –沿x，y，z平面相对于其初始位置将节点从一个位置移动到另一个位置。
- `scale` –根据缩放比例，调整节点的大小以使其在x，y，z平面中显示更大或更小。
- `shear`–旋转一个轴，以使x轴和y轴不再垂直。节点的坐标移动指定的乘数。
- `rotate` –围绕场景的指定枢轴点旋转节点。
- `affine`–执行从2-D / 3-D坐标到其他2-D / 3-D坐标的线性映射，同时保留直线的“直线”和“平行”属性。此类应用使用`Translate`，`Scale`，`Rotate`，或`Shear`变换，而不是直接使用的类。

# Visual Effects

​		JavaFX场景图中富客户端接口的开发涉及使用Visual Effects或Effects来实时增强JavaFX应用程序的外观。JavaFX效果主要基于图像像素，因此，它们采用场景图中的节点集，将其渲染为图像，并对其应用指定的效果。

JavaFX中可用的某些视觉效果包括以下类的使用：

- `Drop Shadow` –在要应用效果的内容后面渲染给定内容的阴影。
- `Reflection` –在实际内容之下呈现内容的反射版本。
- `Lighting` –模拟照在给定内容上的光源，并使平面对象具有更逼真的三维外观。